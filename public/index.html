<!doctype html>
<html lang="th">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>File Vault (Client-Only) ‚Äî ‡πÄ‡∏Ç‡πâ‡∏≤‡∏™‡∏π‡πà‡∏£‡∏∞‡∏ö‡∏ö‡πÑ‡∏î‡πâ‡πÅ‡∏ô‡πà</title>

  <!-- Fonts + Tailwind (CDN) -->
  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link href="https://fonts.googleapis.com/css2?family=Prompt:wght@300;400;600;700&display=swap" rel="stylesheet">
  <script src="https://cdn.tailwindcss.com"></script>

  <style>
    :root{
      --bg:#f5f7fb;--surface:#fff;--text:#0f172a;--muted:#64748b;--line:#e5e7eb;
      --primary:#0ea5e9;--primary-600:#0284c7;--accent:#6366f1;--ring:rgba(14,165,233,.35);
      --radius:16px;--shadow-sm:0 1px 3px rgba(2,8,23,.06);--shadow:0 10px 25px rgba(2,8,23,.08);
      --gradient:linear-gradient(135deg,var(--primary) 0%,var(--accent) 100%);
    }
    *{box-sizing:border-box}
    body{background:var(--bg);color:var(--text);font-family:"Prompt",system-ui,-apple-system,"Segoe UI",Roboto,"Noto Sans Thai","Helvetica Neue",Arial}
    .app-header{position:relative;border-radius:28px;padding:20px 24px;background:var(--gradient);color:#fff;box-shadow:var(--shadow);overflow:hidden}
    .app-header h1{font-weight:800;letter-spacing:-.02em}
    .app-header::after{content:"";position:absolute;inset:-40% -10% auto auto;height:200px;width:200px;filter:blur(60px);background:radial-gradient(closest-side,rgba(255,255,255,.28),transparent)}
    .card{background:var(--surface);border-radius:var(--radius);box-shadow:var(--shadow);border:1px solid rgba(2,8,23,.02)}
    .btn{border-radius:12px;font-weight:600;transition:transform .06s ease,box-shadow .2s ease,background-color .2s ease,color .2s ease,border-color .2s ease;box-shadow:var(--shadow-sm);border:1px solid transparent}
    .btn:active{transform:translateY(1px)}
    .btn-primary{background:var(--primary);color:#fff;border-color:var(--primary-600)}
    .btn-primary:hover{background:var(--primary-600)}
    .btn-outline{background:#fff;color:var(--text);border-color:#e2e8f0}
    .btn-outline:hover{background:#f8fafc}
    .badge{display:inline-flex;align-items:center;gap:6px;background:#eef2ff;color:#3730a3;padding:4px 10px;border-radius:999px;font-size:12px;font-weight:700}
    .muted{color:var(--muted)}
    /* Modal */
    .modal-frame{background:#fff;border-radius:20px;box-shadow:var(--shadow);border:1px solid rgba(2,8,23,.05)}
    .modal-header{display:flex;align-items:center;justify-content:space-between;padding:12px 16px;border-bottom:1px solid #eef2f7}
  </style>
</head>
<body>
  <div class="max-w-5xl mx-auto p-6 space-y-6">
    <!-- Header -->
    <header class="app-header">
      <div class="flex items-start md:items-center justify-between gap-4">
        <div class="space-y-1">
          <h1 class="text-2xl md:text-3xl">üìÅ File Vault</h1>
          <p class="text-sm md:text-base">‡πÄ‡∏î‡πÇ‡∏°‡πÄ‡∏ß‡∏≠‡∏£‡πå‡∏ä‡∏±‡∏ô: ‡∏•‡πá‡∏≠‡∏Å‡∏≠‡∏¥‡∏ô/‡∏™‡∏¥‡∏ó‡∏ò‡∏¥‡πå‡∏ú‡∏π‡πâ‡πÉ‡∏ä‡πâ ‡πÅ‡∏ö‡∏ö‡πÑ‡∏ü‡∏•‡πå‡πÄ‡∏î‡∏µ‡∏¢‡∏ß</p>
          <div class="mt-2 flex flex-wrap gap-2">
            <span class="badge">Client-only</span>
            <span class="badge">LocalStorage</span>
            <span class="badge">Admin/Uploader/Viewer</span>
          </div>
        </div>
        <div class="flex items-center gap-3">
          <!-- ‡∏õ‡∏∏‡πà‡∏°‡πÄ‡∏õ‡∏¥‡∏î modal -->
          <button id="btnOpenLogin" class="btn btn-primary px-3 py-2">‡πÄ‡∏Ç‡πâ‡∏≤‡∏™‡∏π‡πà‡∏£‡∏∞‡∏ö‡∏ö</button>
          <!-- ‡∏Å‡∏•‡πà‡∏≠‡∏á‡∏™‡∏ñ‡∏≤‡∏ô‡∏∞‡∏ú‡∏π‡πâ‡πÉ‡∏ä‡πâ -->
          <div id="authBox" class="flex items-center gap-3"></div>
        </div>
      </div>
    </header>

    <!-- ‡πÄ‡∏ô‡∏∑‡πâ‡∏≠‡∏´‡∏≤‡∏ó‡∏î‡∏•‡∏≠‡∏á (‡πÅ‡∏™‡∏î‡∏á‡∏™‡∏ñ‡∏≤‡∏ô‡∏∞‡∏™‡∏¥‡∏ó‡∏ò‡∏¥‡πå‡∏ó‡∏µ‡πà‡πÉ‡∏ä‡πâ‡∏á‡∏≤‡∏ô‡πÑ‡∏î‡πâ) -->
    <section class="card p-5 space-y-3">
      <h2 class="font-semibold">‡∏™‡∏ñ‡∏≤‡∏ô‡∏∞‡∏Å‡∏≤‡∏£‡πÄ‡∏Ç‡πâ‡∏≤‡∏£‡∏∞‡∏ö‡∏ö</h2>
      <p id="whoami" class="muted text-sm">‡∏¢‡∏±‡∏á‡πÑ‡∏°‡πà‡πÑ‡∏î‡πâ‡πÄ‡∏Ç‡πâ‡∏≤‡∏™‡∏π‡πà‡∏£‡∏∞‡∏ö‡∏ö</p>
      <div class="pt-2 text-xs muted">
        ‡∏ú‡∏π‡πâ‡πÉ‡∏ä‡πâ‡πÄ‡∏£‡∏¥‡πà‡∏°‡∏ï‡πâ‡∏ô: <code>admin@example.com / admin123</code> ‚Ä¢
        <code>uploader@example.com / pass1234</code> ‚Ä¢
        <code>viewer@example.com / viewer123</code>
      </div>
    </section>

    <!-- ‡∏ï‡∏±‡∏ß‡∏≠‡∏¢‡πà‡∏≤‡∏á‡∏™‡∏¥‡∏ó‡∏ò‡∏¥‡πå -->
    <section class="grid grid-cols-1 md:grid-cols-3 gap-4">
      <div class="card p-5 space-y-2">
        <h3 class="font-semibold">‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö‡∏ó‡∏∏‡∏Å‡∏Ñ‡∏ô</h3>
        <ul class="list-disc pl-5 text-sm">
          <li>‡∏î‡∏π‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏™‡∏≤‡∏ò‡∏≤‡∏£‡∏ì‡∏∞</li>
        </ul>
      </div>
      <div class="card p-5 space-y-2">
        <h3 class="font-semibold">‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö uploader/admin</h3>
        <button id="btnWriteThing" class="btn btn-outline px-3 py-2" disabled>‡∏ó‡∏≥‡∏á‡∏≤‡∏ô‡∏ó‡∏µ‡πà‡∏ï‡πâ‡∏≠‡∏á‡∏°‡∏µ‡∏™‡∏¥‡∏ó‡∏ò‡∏¥‡πå‡πÄ‡∏Ç‡∏µ‡∏¢‡∏ô</button>
        <p class="text-xs muted">‡∏õ‡∏∏‡πà‡∏°‡∏ô‡∏µ‡πâ‡∏à‡∏∞‡πÄ‡∏õ‡∏¥‡∏î‡πÑ‡∏î‡πâ‡πÄ‡∏°‡∏∑‡πà‡∏≠‡∏Ñ‡∏∏‡∏ì‡πÄ‡∏õ‡πá‡∏ô uploader ‡∏´‡∏£‡∏∑‡∏≠ admin</p>
      </div>
      <div class="card p-5 space-y-2">
        <h3 class="font-semibold">‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö admin</h3>
        <button id="btnAdminThing" class="btn btn-outline px-3 py-2" disabled>‡∏á‡∏≤‡∏ô‡πÄ‡∏â‡∏û‡∏≤‡∏∞‡∏ú‡∏π‡πâ‡∏î‡∏π‡πÅ‡∏•‡∏£‡∏∞‡∏ö‡∏ö</button>
        <p class="text-xs muted">‡∏õ‡∏∏‡πà‡∏°‡∏ô‡∏µ‡πâ‡∏à‡∏∞‡πÄ‡∏õ‡∏¥‡∏î‡πÑ‡∏î‡πâ‡πÄ‡∏°‡∏∑‡πà‡∏≠‡∏Ñ‡∏∏‡∏ì‡πÄ‡∏õ‡πá‡∏ô admin</p>
      </div>
    </section>
  </div>

  <!-- Login Modal -->
  <div id="loginModal" class="fixed inset-0 bg-black/60 hidden items-center justify-center p-4 z-50">
    <div class="modal-frame w-full max-w-sm">
      <div class="modal-header">
        <h3 class="font-semibold">‡πÄ‡∏Ç‡πâ‡∏≤‡∏™‡∏π‡πà‡∏£‡∏∞‡∏ö‡∏ö</h3>
        <button id="btnCloseLogin" class="btn px-2 py-1">‚úï</button>
      </div>
      <div class="p-4 space-y-3">
        <input id="loginEmail" type="email" placeholder="‡∏≠‡∏µ‡πÄ‡∏°‡∏•" class="w-full border rounded-xl px-3 py-2 text-sm" />
        <input id="loginPassword" type="password" placeholder="‡∏£‡∏´‡∏±‡∏™‡∏ú‡πà‡∏≤‡∏ô" class="w-full border rounded-xl px-3 py-2 text-sm" />
        <button id="btnDoLogin" class="btn btn-primary w-full px-3 py-2 text-sm">‡πÄ‡∏Ç‡πâ‡∏≤‡∏™‡∏π‡πà‡∏£‡∏∞‡∏ö‡∏ö</button>
        <p class="text-xs muted">‡∏ï‡∏±‡∏ß‡∏≠‡∏¢‡πà‡∏≤‡∏á: <code>admin@example.com / admin123</code></p>
      </div>
    </div>
  </div>

  <script>
    // ===== Simplest client-only auth =====
    const USERS_KEY = 'fv_users';
    const SESSION_KEY = 'fv_session';

    function seedUsersIfNeeded() {
      if (localStorage.getItem(USERS_KEY)) return;
      const users = [
        { email: 'admin@example.com', password: 'admin123', role: 'admin' },
        { email: 'uploader@example.com', password: 'pass1234', role: 'uploader' },
        { email: 'viewer@example.com', password: 'viewer123', role: 'viewer' },
      ];
      localStorage.setItem(USERS_KEY, JSON.stringify(users));
    }

    function getUsers() {
      try { return JSON.parse(localStorage.getItem(USERS_KEY)) || []; }
      catch { return []; }
    }
    function findUserByEmail(email) {
      return getUsers().find(u => u.email.toLowerCase() === String(email).toLowerCase());
    }
    function saveSession(user) {
      localStorage.setItem(SESSION_KEY, JSON.stringify({ email: user.email, role: user.role }));
    }
    function clearSession() {
      localStorage.removeItem(SESSION_KEY);
    }
    function getSession() {
      try { return JSON.parse(localStorage.getItem(SESSION_KEY)); }
      catch { return null; }
    }

    // ===== UI wiring =====
    const btnOpenLogin = document.getElementById('btnOpenLogin');
    const loginModal = document.getElementById('loginModal');
    const btnCloseLogin = document.getElementById('btnCloseLogin');
    const btnDoLogin = document.getElementById('btnDoLogin');
    const loginEmail = document.getElementById('loginEmail');
    const loginPassword = document.getElementById('loginPassword');
    const authBox = document.getElementById('authBox');
    const whoami = document.getElementById('whoami');
    const btnWriteThing = document.getElementById('btnWriteThing');
    const btnAdminThing = document.getElementById('btnAdminThing');

    function openLogin(open) {
      if (open) { loginModal.classList.remove('hidden'); loginModal.classList.add('flex'); }
      else { loginModal.classList.add('hidden'); loginModal.classList.remove('flex'); }
    }

    btnOpenLogin.addEventListener('click', () => {
      loginEmail.value = '';
      loginPassword.value = '';
      openLogin(true);
      setTimeout(() => loginEmail.focus(), 50);
    });
    btnCloseLogin.addEventListener('click', () => openLogin(false));

    // ‡∏Å‡∏î Enter ‡πÉ‡∏ô‡∏ä‡πà‡∏≠‡∏á‡∏£‡∏´‡∏±‡∏™‡∏ú‡πà‡∏≤‡∏ô‡πÄ‡∏û‡∏∑‡πà‡∏≠‡πÄ‡∏Ç‡πâ‡∏≤‡∏™‡∏π‡πà‡∏£‡∏∞‡∏ö‡∏ö
    loginPassword.addEventListener('keydown', (e) => {
      if (e.key === 'Enter') btnDoLogin.click();
    });

    btnDoLogin.addEventListener('click', () => {
      const email = loginEmail.value.trim();
      const password = loginPassword.value;
      if (!email || !password) {
        alert('‡∏Å‡∏£‡∏∏‡∏ì‡∏≤‡∏Å‡∏£‡∏≠‡∏Å‡∏≠‡∏µ‡πÄ‡∏°‡∏•‡πÅ‡∏•‡∏∞‡∏£‡∏´‡∏±‡∏™‡∏ú‡πà‡∏≤‡∏ô');
        return;
      }
      const user = findUserByEmail(email);
      if (!user || user.password !== password) {
        alert('‡∏≠‡∏µ‡πÄ‡∏°‡∏•‡∏´‡∏£‡∏∑‡∏≠‡∏£‡∏´‡∏±‡∏™‡∏ú‡πà‡∏≤‡∏ô‡πÑ‡∏°‡πà‡∏ñ‡∏π‡∏Å‡∏ï‡πâ‡∏≠‡∏á');
        return;
      }
      saveSession(user);
      renderAuth();
      openLogin(false);
    });

    function renderAuth() {
      authBox.innerHTML = '';
      const session = getSession();

      if (!session) {
        // ‡∏¢‡∏±‡∏á‡πÑ‡∏°‡πà‡∏•‡πá‡∏≠‡∏Å‡∏≠‡∏¥‡∏ô
        whoami.textContent = '‡∏¢‡∏±‡∏á‡πÑ‡∏°‡πà‡πÑ‡∏î‡πâ‡πÄ‡∏Ç‡πâ‡∏≤‡∏™‡∏π‡πà‡∏£‡∏∞‡∏ö‡∏ö';
        btnOpenLogin.classList.remove('hidden');

        const b = document.createElement('button');
        b.textContent = '‡πÄ‡∏Ç‡πâ‡∏≤‡∏™‡∏π‡πà‡∏£‡∏∞‡∏ö‡∏ö';
        b.className = 'btn btn-outline px-3 py-2 text-sm';
        b.addEventListener('click', () => btnOpenLogin.click());
        authBox.appendChild(b);

        // ‡∏õ‡∏¥‡∏î‡∏™‡∏¥‡∏ó‡∏ò‡∏¥‡πå
        btnWriteThing.disabled = true;
        btnAdminThing.disabled = true;
      } else {
        // ‡∏•‡πá‡∏≠‡∏Å‡∏≠‡∏¥‡∏ô‡πÅ‡∏•‡πâ‡∏ß
        whoami.textContent = `‡∏Å‡∏≥‡∏•‡∏±‡∏á‡πÉ‡∏ä‡πâ‡∏á‡∏≤‡∏ô‡πÉ‡∏ô‡∏ä‡∏∑‡πà‡∏≠ ${session.email} (‡∏™‡∏¥‡∏ó‡∏ò‡∏¥‡πå: ${session.role})`;
        btnOpenLogin.classList.add('hidden');

        const span = document.createElement('span');
        span.className = 'text-sm muted';
        span.textContent = `${session.email} (${session.role})`;

        const out = document.createElement('button');
        out.textContent = '‡∏≠‡∏≠‡∏Å‡∏à‡∏≤‡∏Å‡∏£‡∏∞‡∏ö‡∏ö';
        out.className = 'btn btn-outline px-3 py-2 text-sm';
        out.addEventListener('click', () => {
          clearSession();
          renderAuth();
        });

        authBox.append(span, out);

        // ‡πÄ‡∏õ‡∏¥‡∏î‡∏™‡∏¥‡∏ó‡∏ò‡∏¥‡πå‡∏ï‡∏≤‡∏° role
        const canWrite = session.role === 'admin' || session.role === 'uploader';
        btnWriteThing.disabled = !canWrite;
        btnAdminThing.disabled = session.role !== 'admin';
      }
    }

    // ===== Boot =====
    (function init() {
      seedUsersIfNeeded();
      renderAuth();
    })();
  </script>
</body>
</html>
